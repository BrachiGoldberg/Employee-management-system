import './polyfills.server.mjs';
import{a as O}from"./chunk-DGRP5DN6.mjs";import{a as he}from"./chunk-XMXHUUNW.mjs";import{b as G,c as W,d as g,f as w,g as f,h as S,i as N,j as ne,k as ae,l as E,m as se,o as I,p as U,q as me,r as k,s as le,t as de,u as pe,v as y,w as ce,x as ue,z as fe}from"./chunk-ICNSTGZV.mjs";import{k as _,n as v,o as re,q as Q}from"./chunk-5NANDZA3.mjs";import{$a as t,Ba as l,Ca as d,S as j,Sa as c,Ua as b,Wa as u,_a as a,_b as oe,aa as C,ab as p,ba as A,bb as te,db as h,eb as T,ia as R,ib as ie,ja as B,jb as s,lb as L,mb as Y,nb as H,ob as K}from"./chunk-KJXMZDJA.mjs";import{g as V}from"./chunk-VVCT4QZE.mjs";var M=V(G());function we(r,i){r&1&&(a(0,"div",7),s(1," UserName is required "),t())}function Se(r,i){r&1&&(a(0,"div",7),s(1," Password is required "),t())}var ye=(()=>{let i=class i{constructor(e,o){this._service=e,this._router=o,this.passwordVisible=!1}ngOnInit(){sessionStorage.clear()}login(){this._service.loginToCompany(this.password,this.userName).subscribe({next:e=>{let o;M.default.fire({position:"top-end",title:"You've logged in successfully",timer:2e3,timerProgressBar:!0,showCloseButton:!1,didOpen:()=>{let n=M.default.getPopup().querySelector("b");o=setInterval(()=>{n?.textContent&&(n.textContent=`${M.default.getTimerLeft()}`)},100)},willClose:()=>{clearInterval(o)}}),sessionStorage.setItem("token",e.token),sessionStorage.setItem("company",JSON.stringify(e.company)),this._router.navigate(["employee"])},error:e=>{e.status==401?this.massegeLoginFails():this._router.navigate(["error"])}})}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}massegeLoginFails(){M.default.fire({title:"Authentication failed",text:"User name or password are not correct, please fix it",footer:"Do you not have an account? You can create a new accoutn now!",showCancelButton:!0,cancelButtonText:"Create new account"}).then(e=>{e.isDismissed?this._router.navigate(["company/new-company"]):e.isConfirmed&&(this.userName=this.password="")})}};i.\u0275fac=function(o){return new(o||i)(d(y),d(v))},i.\u0275cmp=C({type:i,selectors:[["app-login-to-company"]],decls:17,vars:5,consts:[["loginForm","ngForm"],["routerLink","../new-company",1,"center"],[1,"container","d-flex","justify-content-center","align-items-center","vh-100"],[1,"w-50",3,"submit"],[1,"mb-3"],["for","userName",1,"form-label"],["type","text","id","userName","name","userName","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-danger"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(o,n){if(o&1){let m=te();a(0,"a",1),s(1,"Create new Company account, please click here"),t(),a(2,"div",2)(3,"form",3,0),h("submit",function(){return R(m),B(n.login())}),a(5,"div",4)(6,"label",5),s(7,"User Name"),t(),a(8,"input",6),K("ngModelChange",function(x){return R(m),H(n.userName,x)||(n.userName=x),B(x)}),t(),c(9,we,2,0,"div",7),t(),a(10,"div",4)(11,"label",8),s(12,"Password"),t(),a(13,"input",9),K("ngModelChange",function(x){return R(m),H(n.password,x)||(n.password=x),B(x)}),t(),c(14,Se,2,0,"div",7),t(),a(15,"button",10),s(16,"Login"),t()()()}if(o&2){let m=ie(4);l(8),Y("ngModel",n.userName),l(),u(9,m.controls.userName!=null&&m.controls.userName.invalid&&(m.controls.userName.dirty||m.controls.userName.touched)?9:-1),l(4),Y("ngModel",n.password),l(),u(14,m.controls.password!=null&&m.controls.password.invalid&&(m.controls.password.dirty||m.controls.password.touched)?14:-1),l(),b("disabled",m.invalid)}},dependencies:[re,E,w,S,N,me,ae,ne]});let r=i;return r})();var z=class{};var D=V(G());function Ne(r,i){r&1&&(a(0,"span",23),s(1,"Day salaries calculation is required"),t())}function Ee(r,i){r&1&&(a(0,"span",23),s(1,"Day salaries calculation value must have between 1 to 30"),t())}function Fe(r,i){if(r&1&&c(0,Ne,2,0,"span",23)(1,Ee,2,0),r&2){let P=T();u(0,P.termsControlers.daySalariesCalculation.errors.required?0:1)}}var Z=(()=>{let i=class i{constructor(e,o,n,m){this._router=e,this._service=o,this._fb=n,this._activated=m,this.companyTerms=new z,this.validForm=!0}ngOnInit(){this.createForm(),this._activated.url.subscribe(e=>this.url=e[0].path),this.url=="new-termss"?this.createForm():this._activated.params.subscribe({next:e=>{let o=e.id;o&&(this.id=o,this.getCompanyTerms());let n=e.compId;n&&(this.compId=n)}})}createForm(){this.termsForm=this._fb.group({meals:[this.companyTerms.meals],nightShiftPrecent:[this.companyTerms.nightShiftPrecent],shabbatShiftPrecent:[this.companyTerms.shabbatShiftPrecent],gifts:[this.companyTerms.gifts],clothing:[this.companyTerms.clothing],recovery:[this.companyTerms.recovery],birthDays:[this.companyTerms.birthDays],daySalariesCalculation:[this.companyTerms.daySalariesCalculation,f.compose([f.required,f.min(1),f.max(30)])]})}get termsControlers(){return this.termsForm.controls}getCompanyTerms(){this._service.getCompanyTermsById(this.id).subscribe({next:e=>{this.companyTerms=e,this.createForm()},error:e=>{e.status==401?g():this._router.navigate(["error"])}})}submitForm(){this.termsForm.status=="VALID"?(this.validForm=!0,this.companyTerms=this.termsForm.value,this.url=="new-terms"?this.AddNewTerms():this.updateTerms()):this.validForm=!1}AddNewTerms(){this._service.addCompanyTerms(this.companyTerms).subscribe({next:e=>{this.sendNewCompany(e.id)},error:e=>{e.status==400?this.massegeOfError():this._router.navigate(["error"])}})}sendNewCompany(e){let o=sessionStorage.getItem("new-comp"),n=sessionStorage.getItem("managerId");if(o&&n){let m=JSON.parse(o);m.manager={companyId:0,identity:n},this._service.addNewCompany(m,e).subscribe({next:F=>{D.default.fire({position:"top-end",icon:"success",title:"The company has been successfully added",showConfirmButton:!1,timer:1500}),sessionStorage.setItem("token",F.token),sessionStorage.setItem("company",JSON.stringify(F.company)),this._router.navigate(["employee/add-manager"])},error:F=>{F.status==400?this.massegeOfErrorDetails():this._router.navigate(["error"])}})}else D.default.fire({icon:"error",title:"Oops...",text:"there is an error, please check all the details are correct",allowOutsideClick:!0})}updateTerms(){this._service.updateCompanyTerms(this.id,this.companyTerms).subscribe({next:()=>{D.default.fire({position:"top-end",icon:"success",title:"The changes were successfully saved",showConfirmButton:!1,timer:1500}),this._router.navigate([`company/details/${this.compId}`])},error:e=>{e.status==401?g():e.status==404?this.notFound():e.status==400&&this.badRequest()}})}notFound(){this._router.navigate([`error?mess=${W.NOTFOUND}`])}badRequest(){D.default.fire({icon:"error",title:"Oops...",text:"It looks like something is wrong with your request, please try again",allowOutsideClick:!0})}massegeOfErrorDetails(){D.default.fire({icon:"error",title:"Oops...",text:"It seems that the company name or username already exists in the system",allowOutsideClick:!0,didClose:()=>this._router.navigate(["company/new-company"])})}massegeOfError(){D.default.fire({icon:"error",title:"Oops...",text:"Did you enter all the required details? Please verify the integrity of the document",allowOutsideClick:!0})}};i.\u0275fac=function(o){return new(o||i)(d(v),d(y),d(k),d(_))},i.\u0275cmp=C({type:i,selectors:[["app-company-terms"]],decls:41,vars:2,consts:[[1,"container-fluid","center"],[1,"row","justify-content-center"],[1,"col-lg-6"],[1,"my-4"],[1,"card","p-4",3,"formGroup"],[1,"mb-3"],["for","meals",1,"form-label"],["id","meals","formControlName","meals","type","number",1,"form-control"],["for","nightShiftPrecent",1,"form-label"],["id","nightShiftPrecent","formControlName","nightShiftPrecent","type","number",1,"form-control"],["for","shabbatShiftPrecent",1,"form-label"],["id","shabbatShiftPrecent","formControlName","shabbatShiftPrecent","type","number",1,"form-control"],["for","gifts",1,"form-label"],["id","gifts","formControlName","gifts","type","number",1,"form-control"],["for","clothing",1,"form-label"],["id","clothing","formControlName","clothing","type","number",1,"form-control"],["for","recovery",1,"form-label"],["id","recovery","formControlName","recovery","type","number",1,"form-control"],["for","birthDays",1,"form-label"],["id","birthDays","formControlName","birthDays","type","number",1,"form-control"],["for","daySalariesCalculation",1,"form-label"],["id","daySalariesCalculation","formControlName","daySalariesCalculation","type","number",1,"form-control"],["type","button",1,"btn","btn-primary",3,"click"],[1,"text-danger"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),s(4,"Company Terms"),t(),a(5,"form",4)(6,"div",5)(7,"label",6),s(8,"Meals"),t(),p(9,"input",7),t(),a(10,"div",5)(11,"label",8),s(12,"Night Shift Precent"),t(),p(13,"input",9),t(),a(14,"div",5)(15,"label",10),s(16,"Shabbat Shift Precent"),t(),p(17,"input",11),t(),a(18,"div",5)(19,"label",12),s(20,"Gifts"),t(),p(21,"input",13),t(),a(22,"div",5)(23,"label",14),s(24,"Clothing"),t(),p(25,"input",15),t(),a(26,"div",5)(27,"label",16),s(28,"Recovery"),t(),p(29,"input",17),t(),a(30,"div",5)(31,"label",18),s(32,"BirthDays"),t(),p(33,"input",19),t(),a(34,"div",5)(35,"label",20),s(36,"Day Salaries Calculation"),t(),p(37,"input",21),c(38,Fe,2,1),t(),a(39,"button",22),h("click",function(){return n.submitForm()}),s(40,"Save"),t()()()()()),o&2&&(l(5),b("formGroup",n.termsForm),l(33),u(38,!n.validForm&&n.termsControlers.daySalariesCalculation.errors?38:-1))},dependencies:[E,w,se,S,N,I,U]});let r=i;return r})();var Ce=(()=>{let i=class i{constructor(e,o,n){this._service=e,this._router=o,this._activated=n}ngOnInit(){this._activated.params.subscribe({next:e=>{let o=e.id;o&&(this.id=o,this.getCompanyDetails())}})}getCompanyDetails(){this._service.getCompanyById(this.id).subscribe({next:e=>{this.company=e},error:e=>{e.status==401?g():this._router.navigate(["error"])}})}updateCompany(){this._router.navigate([`company/update-company/${this.id}`])}updateTerms(){this._router.navigate([`company/comp-id/${this.id}/update-terms/${this.company.termsId}`])}updateEntryDetails(){let e={userName:this.company?.userName,password:this.company?.password};sessionStorage.setItem("entryDetails",JSON.stringify(e)),this._router.navigate([`company/comp-id/${this.id}/update-entry-details`])}};i.\u0275fac=function(o){return new(o||i)(d(y),d(v),d(_))},i.\u0275cmp=C({type:i,selectors:[["app-company-details"]],decls:23,vars:3,consts:[[1,"card","center"],[1,"card-header"],[1,"card-body"],["type","button",1,"btn","btn-primary","mt-3","me-2",3,"click"],["type","button",1,"btn","btn-primary","mt-3",3,"click"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"h3"),s(3,"Company Details"),t()(),a(4,"div",2)(5,"div")(6,"strong"),s(7,"Name:"),t(),s(8),t(),a(9,"div")(10,"strong"),s(11,"Email:"),t(),s(12),t(),a(13,"div")(14,"strong"),s(15,"Address:"),t(),s(16),t(),a(17,"button",3),h("click",function(){return n.updateCompany()}),s(18,"Update Company Details"),t(),a(19,"button",3),h("click",function(){return n.updateTerms()}),s(20,"Update Company Terms"),t(),a(21,"button",4),h("click",function(){return n.updateEntryDetails()}),s(22,"Update User Name and Password"),t()()()),o&2&&(l(8),L(" ",n.company==null?null:n.company.name," "),l(4),L(" ",n.company==null?null:n.company.email," "),l(4),L(" ",n.company==null?null:n.company.address," "))}});let r=i;return r})();var ve=V(G());function xe(r,i){r&1&&(a(0,"span",8),s(1,"Name is required"),t())}function De(r,i){r&1&&(a(0,"span",8),s(1,"Description is required"),t())}function Te(r,i){r&1&&(a(0,"span",8),s(1,"Address is required"),t())}function Ie(r,i){r&1&&(a(0,"span",8),s(1,"Email is required"),t())}function Ue(r,i){r&1&&(a(0,"span",8),s(1,"Email address is invalid"),t())}function ke(r,i){if(r&1&&c(0,Ie,2,0,"span",8)(1,Ue,2,0),r&2){let P=T();u(0,P.updateFormControls.email.errors.required?0:1)}}var ge=(()=>{let i=class i{constructor(e,o,n,m){this._router=e,this._service=o,this._fb=n,this._activated=m,this.company=new pe,this.validForm=!0}ngOnInit(){this.createForm(),this._activated.params.subscribe({next:e=>{let o=e.id;o&&(this.id=o,this.getCompany())}})}getCompany(){this._service.getCompanyById(this.id).subscribe({next:e=>{this.company=e,this.createForm()},error:e=>{e.status==401?g():e.status==404?this.NotFoundPage():this._router.navigate(["error"])}})}createForm(){this.updateForm=this._fb.group({name:[this.company.name,[f.required]],description:[this.company.description,[f.required]],address:[this.company.address,[f.required]],email:[this.company.email,f.compose([f.required,ce])]})}get updateFormControls(){return this.updateForm.controls}saveChanges(){if(this.updateForm.status=="VALID"){this.validForm=!0;let e=this.company.termsId;this.company=this.updateForm.value,this.company.termsId=e,this._service.updateCompany(this.id,this.company).subscribe({next:()=>{ve.default.fire({position:"top-end",icon:"success",title:"The changes were successfully saved",showConfirmButton:!1,timer:1500}),this._router.navigate([`company/details/${this.id}`])},error:o=>{o.status==401?g():o.status==400?this.BadRequest():o.status==404?this.NotFoundPage():this._router.navigate(["error"])}})}else this.validForm=!1}NotFoundPage(){this._router.navigate(["error?mess=pageNotFound"])}BadRequest(){this._router.navigate(["error?mess=badRequest"])}};i.\u0275fac=function(o){return new(o||i)(d(v),d(y),d(k),d(_))},i.\u0275cmp=C({type:i,selectors:[["app-update-company-details"]],decls:28,vars:5,consts:[[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-lg-6"],[1,"card","p-4",3,"formGroup"],[1,"mb-4","fw-semibold"],[1,"mb-3"],["for","name",1,"form-label","fw-semibold"],["id","name","formControlName","name","name","name",1,"form-control"],[1,"text-danger"],["for","description",1,"form-label","fw-semibold"],["id","description","formControlName","description","name","description",1,"form-control"],["for","address",1,"form-label","fw-semibold"],["id","address","formControlName","address","name","address",1,"form-control"],["for","email",1,"form-label","fw-semibold"],["id","email","formControlName","email","name","email",1,"form-control"],[1,"btn","btn-primary",3,"click"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"h3",4),s(5,"Update Company Details"),t(),a(6,"div",5)(7,"label",6),s(8,"Company Name"),t(),p(9,"input",7),c(10,xe,2,0,"span",8),t(),a(11,"div")(12,"label",9),s(13,"Description your comapny"),t(),p(14,"input",10),c(15,De,2,0,"span",8),t(),a(16,"div")(17,"label",11),s(18,"Company Address"),t(),p(19,"input",12),c(20,Te,2,0,"span",8),t(),a(21,"div")(22,"label",13),s(23,"Company Email"),t(),p(24,"input",14),c(25,ke,2,1),t(),a(26,"button",15),h("click",function(){return n.saveChanges()}),s(27,"Save Changes"),t()()()()()),o&2&&(l(3),b("formGroup",n.updateForm),l(7),u(10,!n.validForm&&n.updateFormControls.name.errors?10:-1),l(5),u(15,!n.validForm&&n.updateFormControls.description.errors?15:-1),l(5),u(20,!n.validForm&&n.updateFormControls.address.errors?20:-1),l(5),u(25,!n.validForm&&n.updateFormControls.email.errors?25:-1))},dependencies:[E,w,S,N,I,U]});let r=i;return r})();var ee=V(G());function qe(r,i){r&1&&(a(0,"span",8),s(1,"User name is required"),t())}function Pe(r,i){r&1&&(a(0,"span",8),s(1,"Password is required"),t())}function Oe(r,i){r&1&&(a(0,"span",8),s(1,"Password should contain at least 8 characters, one uppercase letter, one lowercase letter and one number "),t())}function Me(r,i){if(r&1&&c(0,Pe,2,0,"span",8)(1,Oe,2,0),r&2){let P=T();u(0,P.entryFormControls.password.errors.required?0:1)}}var be=(()=>{let i=class i{constructor(e,o,n,m){this._router=e,this._service=o,this._fb=n,this._activated=m,this.entryDetails={password:"",userName:""},this.validForm=!0}ngOnInit(){this._activated.params.subscribe({next:o=>{let n=o.id;n&&(this.compId=n)}});let e=sessionStorage.getItem("entryDetails");if(e){let o=JSON.parse(e);this.entryDetails.password=o.password,this.entryDetails.userName=o.userName,sessionStorage.removeItem("entryDetails"),this.createForm()}}createForm(){this.entryForm=this._fb.group({userName:[this.entryDetails.userName,f.required],password:[this.entryDetails.password,f.compose([f.required,ue])]})}get entryFormControls(){return this.entryForm.controls}saveChanges(){this.entryForm.status=="VALID"?(this.validForm=!0,this.entryDetails=this.entryForm.value,this._service.updateCompanyEntryDetails(this.compId,this.entryDetails.userName,this.entryDetails.password).subscribe({next:()=>{ee.default.fire({position:"top-end",icon:"success",title:"The changes were successfully saved",showConfirmButton:!1,timer:1500}),this._router.navigate([`company/details/${this.compId}`])},error:e=>{e.status==401?g():e.status==400?this.BadRequest():e.status==404?this.PageNotFound():this._router.navigate(["error"])}})):this.validForm=!1}BadRequest(){ee.default.fire({icon:"error",title:"Oops...",text:"It's seems there is an error, Please verify the integrity of the document",allowOutsideClick:!0})}PageNotFound(){this._router.navigate([`error?mess=${W.NOTFOUND}`])}};i.\u0275fac=function(o){return new(o||i)(d(v),d(y),d(k),d(_))},i.\u0275cmp=C({type:i,selectors:[["app-update-company-entry-details"]],decls:18,vars:3,consts:[[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-lg-6"],[1,"my-4"],[1,"card","p-4",3,"formGroup"],[1,"mb-3"],["for","userName",1,"form-label"],["id","userName","formControlName","userName","name","userName",1,"form-control"],[1,"text-danger"],["for","password",1,"form-label"],["id","password","formControlName","password","name","password",1,"form-control"],[1,"btn","btn-primary",3,"click"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),s(4,"User Name and Password"),t(),a(5,"form",4)(6,"div",5)(7,"label",6),s(8,"Company UserName"),t(),p(9,"input",7),c(10,qe,2,0,"span",8),t(),a(11,"div",5)(12,"label",9),s(13,"Company Password"),t(),p(14,"input",10),c(15,Me,2,1),t(),a(16,"button",11),h("click",function(){return n.saveChanges()}),s(17,"Save changes"),t()()()()()),o&2&&(l(5),b("formGroup",n.entryForm),l(5),u(10,!n.validForm&&n.entryFormControls.userName.errors?10:-1),l(5),u(15,!n.validForm&&n.entryFormControls.password.errors?15:-1))},dependencies:[E,w,S,N,I,U]});let r=i;return r})();var Ve=[{path:"",redirectTo:"login-company",pathMatch:"full"},{path:"login-company",component:ye},{path:"new-company",component:fe},{path:"update-company/:id",component:ge,canActivate:[O]},{path:"new-terms",component:Z},{path:"comp-id/:compId/update-terms/:id",component:Z,canActivate:[O]},{path:"details/:id",component:Ce,canActivate:[O]},{path:"comp-id/:id/update-entry-details",component:be,canActivate:[O]}],_e=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=A({type:i}),i.\u0275inj=j({imports:[Q.forChild(Ve),Q]});let r=i;return r})();var xt=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=A({type:i}),i.\u0275inj=j({providers:[y],imports:[oe,_e,le,de,he]});let r=i;return r})();export{xt as CompanyModule};
